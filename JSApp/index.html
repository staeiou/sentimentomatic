<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex">
  <meta name="description" content="Analyze text sentiment using multiple ML models including VADER, AFINN, and transformer-based models">
  <title>Stuart's Super Magic Sentiment-O-Matic</title>
  <link rel="stylesheet" href="/src/styles.css">
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <div class="neon-sign">
        <h1 class="app-title">
          <a href="http://sentimentomatic.stuartgeiger.com">
            <span class="title-super">Stuart's Super Magic</span>
            <span class="title-main">SENTIMENT-O-MATIC</span>
          </a>
        </h1>
        <div class="app-tagline">
          ‚ö° Step Right Up! Test Your Text's True Feelings! ‚ö°
        </div>
      </div>
    </header>

    <main class="app-main">
      <div class="instructions-card">
        <h2 class="step-number">üé™ Three Simple Steps</h2>
        <div class="instructions-steps">
          <div class="step">
            <span class="step-badge">1</span>
            <span>Enter your text below</span>
          </div>
          <div class="step">
            <span class="step-badge">2</span>
            <span>Select analysis models</span>
          </div>
          <div class="step">
            <span class="step-badge">3</span>
            <span>Click Analyze for results</span>
          </div>
        </div>
      </div>

      <div class="privacy-banner">
        <span class="privacy-icon">üé™</span>
        <span class="privacy-text">
          <strong>No Cloud Behind the Curtain:</strong> Local-first privacy ‚Ä¢ Your text is processed 100% in your browser and is not sent to any server ‚Ä¢ Internet is only used to download this web app and models from HuggingFace
        </span>
      </div>

      <section class="input-section" aria-label="Text Input">
        <div class="carnival-step step-1">STEP 1</div>
        <div class="input-header">
          <div class="header-left">
            <h3>üé∞ Insert Texts Here</h3>
            <span class="input-hint">1 line = 1 unit of text to analyze</span>
          </div>
          <div class="text-buttons">
            <button type="button" id="template-generator-btn" class="btn btn-secondary btn-sm">üé≠ Generate from Mad Libs Template</button>
            <button type="button" id="sample-datasets-btn" class="btn btn-secondary btn-sm">üìä Load Sample Data</button>
            <button type="button" id="import-file-btn" class="btn btn-secondary btn-sm">üì§ Import from File</button>
            <button type="button" id="clear-text-btn" class="btn btn-secondary btn-sm">Clear Text</button>
          </div>
        </div>
        <div id="text-input" class="code-editor"></div>
      </section>

      <section class="controls-section" aria-label="Analysis Controls">
        <div class="carnival-step step-2">STEP 2</div>
        <div class="controls-header">
          <h3 class="section-title">üéõÔ∏è Choose Your Oracles</h3>
          <div class="model-buttons">
            <button type="button" id="select-all-models-btn" class="btn btn-secondary btn-sm">Select All Models</button>
            <button type="button" id="clear-models-btn" class="btn btn-secondary btn-sm">Clear All Models</button>
          </div>
        </div>
        <p class="section-description">Each model analyzes sentiment differently - select the ones you want to compare</p>
        <div class="models-grid">
          <fieldset class="model-group">
            <legend>Sentiment Models</legend>
            <div class="model-subgroup">
              <div class="subgroup-header-row">
                <h4 class="subgroup-header">Rule-Based Models</h4>
                <span class="size-header">Size</span>
              </div>
              <label class="model-option">
                <input type="checkbox" id="use-vader" checked>
                <a href="https://github.com/vaderSentiment/vaderSentiment-js" target="_blank" rel="noopener">VADER</a>
                <span class="model-size">1MB</span>
              </label>
              <label class="model-option">
                <input type="checkbox" id="use-afinn">
                <a href="https://github.com/thisandagain/sentiment" target="_blank" rel="noopener">AFINN</a>
                <span class="model-size">1MB</span>
              </label>
            </div>
            <div class="model-subgroup">
              <div class="subgroup-header-row">
                <h4 class="subgroup-header">Neural Network Models</h4>
                <span class="size-header">Size</span>
              </div>
              <label class="model-option">
                <input type="checkbox" id="use-distilbert" checked>
                <a href="https://huggingface.co/Xenova/distilbert-base-uncased-finetuned-sst-2-english" target="_blank" rel="noopener">DistilBERT SST-2</a>
                <span class="model-size">65MB</span>
              </label>
              <label class="model-option">
                <input type="checkbox" id="use-twitter-roberta">
                <a href="https://huggingface.co/Xenova/twitter-roberta-base-sentiment-latest" target="_blank" rel="noopener">Twitter RoBERTa</a>
                <span class="model-size">122MB</span>
              </label>
              <label class="model-option">
                <input type="checkbox" id="use-financial">
                <a href="https://huggingface.co/Xenova/finbert" target="_blank" rel="noopener">Financial DistilRoBERTa</a>
                <span class="model-size">106MB</span>
              </label>
              <label class="model-option">
                <input type="checkbox" id="use-multilingual-student">
                <a href="https://huggingface.co/Xenova/distilbert-base-multilingual-cased-sentiments-student" target="_blank" rel="noopener">Multilingual DistilBERT</a>
                <span class="model-size">132MB</span>
              </label>
            </div>
          </fieldset>

          <fieldset class="model-group">
            <legend>Classification</legend>
            <div class="classification-header-row">
              <span class="classification-label">Model</span>
              <span class="size-header">Size</span>
            </div>
            <label class="model-option">
              <input type="checkbox" id="use-goemotions" checked>
              <a href="https://huggingface.co/SamLowe/roberta-base-go_emotions-onnx" target="_blank" rel="noopener">GoEmotions</a>
              <span class="model-size">122MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-jigsaw-toxicity" checked>
              <a href="https://huggingface.co/minuva/MiniLMv2-toxic-jigsaw-onnx" target="_blank" rel="noopener">Jigsaw Toxicity</a>
              <span class="model-size">22MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-koala-moderation">
              <a href="https://huggingface.co/KoalaAI/Text-Moderation" target="_blank" rel="noopener">KoalaAI Content Moderation</a>
              <span class="model-size">140MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-toxic-bert">
              <a href="https://huggingface.co/Xenova/toxic-bert" target="_blank" rel="noopener">Toxic BERT</a>
              <span class="model-size">106MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-iptc-news">
              <a href="https://huggingface.co/onnx-community/multilingual-IPTC-news-topic-classifier-ONNX" target="_blank" rel="noopener">IPTC News Topics</a>
              <span class="model-size">553MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-language-detection">
              <a href="https://huggingface.co/protectai/xlm-roberta-base-language-detection-onnx" target="_blank" rel="noopener">Language Detection</a>
              <span class="model-size">282MB</span>
            </label>
            <label class="model-option">
              <input type="checkbox" id="use-industry-classification">
              <a href="https://huggingface.co/sabatale/industry-classification-api-onnx" target="_blank" rel="noopener">Industry Classification</a>
              <span class="model-size">106MB</span>
            </label>
          </fieldset>
        </div>

        <div class="cache-options">
          <div class="cache-controls">
            <label class="cache-option">
              <input type="checkbox" id="keep-models-cached">
              Keep downloaded models in browser cache
            </label>
            <button type="button" id="clear-cache" class="btn btn-secondary btn-sm">Clear Cache</button>
            <button type="button" id="debug-cache" class="btn btn-secondary btn-sm">Debug Cache</button>
          </div>
          <span id="cache-stats" class="cache-stats">
            <span class="cache-size">0 MB used</span>
          </span>
        </div>

        <div class="action-bar">
          <div class="carnival-step step-3">STEP 3</div>
          <div class="analyze-button-container">
            <button type="button" id="analyze-btn" class="btn btn-primary">Analyze</button>
          </div>
        </div>
      </section>

      <section id="results-section" class="results-section" aria-label="Analysis Results" hidden>
        <h2>üìä Analysis Results</h2>
        <div class="results-toolbar">
          <div class="export-buttons">
            <button type="button" id="export-csv" class="btn btn-secondary">Export CSV</button>
            <button type="button" id="export-excel" class="btn btn-secondary">Export Excel</button>
            <button type="button" id="export-json" class="btn btn-secondary">Export JSON</button>
          </div>
          <div class="export-options" id="export-options" style="display: none;">
            <label class="export-option">
              <input type="checkbox" id="export-multiclass-columns">
              Export individual class columns for classification models
            </label>
          </div>
        </div>
        <div id="results-table" class="results-container"></div>
      </section>

      <section class="research-note">
        <h3>üî¨ About This Tool</h3>
        <p>
          This tool helps you explore how different sentiment analysis models evaluate emotion in text.
          Each model was trained differently and may give different results - that's intentional!
        </p>
        <p>
          <strong>Questions to consider:</strong> Which results make the most sense? What seems off?
          Would you trust these models to moderate social media content or analyze customer feedback?
        </p>
        <p class="citation-info">
          Created for research and education by <a href="https://stuartgeiger.com">R. Stuart Geiger</a>.
          Sentiment models from <a href="https://github.com/cjhutto/vaderSentiment">VADER</a>,
          <a href="https://huggingface.co">HuggingFace</a>, and other sources.
        </p>
      </section>
    </main>

    <footer class="app-footer">
      <p>by <a href="https://stuartgeiger.com">R. Stuart Geiger</a>, JS version with advanced ML models.</p>
    </footer>
  </div>

  <!-- Sample Datasets Modal -->
  <div id="sample-datasets-modal" class="template-generator-overlay" style="display: none;">
    <div class="sample-datasets-modal">
      <div class="modal-header">
        <h3>üìä Sample Datasets</h3>
        <button type="button" class="modal-close" id="sample-datasets-modal-close">&times;</button>
      </div>

      <div class="modal-body">
        <p class="modal-description">
          Choose curated datasets to test different sentiment analysis scenarios and discover model biases.
          Each dataset contains 25 carefully selected examples designed to reveal how different models behave.
        </p>

        <div class="load-options">
          <h3>‚öôÔ∏è Load Options</h3>
          <div class="load-options-group">
            <label class="load-option">
              <input type="radio" name="load-mode" value="replace" checked>
              <span class="option-label">Replace current text</span>
              <span class="option-description">Clear existing text and load the selected dataset</span>
            </label>
            <label class="load-option">
              <input type="radio" name="load-mode" value="append">
              <span class="option-label">Append to current text</span>
              <span class="option-description">Add the dataset to your existing text for comparison</span>
            </label>
          </div>
        </div>

        <div class="datasets-grid" id="datasets-grid">
          <!-- Datasets will be populated by JavaScript -->
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="sample-datasets-cancel">Close</button>
      </div>
    </div>
  </div>

  <!-- Preview Modal -->
  <div id="dataset-preview-modal" class="template-generator-overlay" style="display: none;">
    <div class="dataset-preview-modal">
      <div class="modal-header">
        <h3 id="preview-modal-title">Dataset Preview</h3>
        <button type="button" class="modal-close" id="preview-modal-close">&times;</button>
      </div>

      <div class="modal-body">
        <div class="preview-info" id="preview-info">
          <!-- Dataset info will be populated by JavaScript -->
        </div>
        <div class="preview-content" id="preview-content">
          <!-- Preview lines will be populated by JavaScript -->
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="preview-close">Close</button>
        <button type="button" class="btn btn-primary" id="preview-load">Load This Dataset</button>
      </div>
    </div>
  </div>

  <!-- File Import Modal - Step 1: Upload -->
  <div id="file-upload-modal" class="template-generator-overlay" style="display: none;">
    <div class="file-import-modal">
      <div class="modal-header">
        <h3>üì§ Import from File</h3>
        <button type="button" class="modal-close" id="file-upload-modal-close">&times;</button>
      </div>

      <div class="modal-body">
        <p class="modal-description">
          Upload a CSV, TSV, or Excel file to extract text data for sentiment analysis.
        </p>

        <div class="file-upload-zone" id="file-upload-zone">
          <div class="upload-content">
            <div class="upload-icon">üìÅ</div>
            <div class="upload-text">
              <strong>Drop files here or click to browse</strong>
              <br>
              <span class="upload-hint">Supported: CSV, TSV, Excel (.xlsx)</span>
            </div>
          </div>
          <input type="file" id="file-input" accept=".csv,.tsv,.xlsx,.xls" style="display: none;">
        </div>

        <div class="file-constraints">
          <div class="constraint-item">üìä Maximum file size: 10MB</div>
          <div class="constraint-item">üìù Maximum rows: 5,000</div>
          <div class="constraint-item">üîß Automatic text detection</div>
        </div>

        <div class="upload-progress" id="upload-progress" style="display: none;">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
          <div class="progress-text" id="progress-text">Processing file...</div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="file-upload-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- File Import Modal - Step 2: Column Selection -->
  <div id="column-selection-modal" class="template-generator-overlay" style="display: none;">
    <div class="column-selection-modal">
      <div class="modal-header">
        <h3>üìù Select Text Column</h3>
        <button type="button" class="modal-close" id="column-selection-modal-close">&times;</button>
      </div>

      <div class="modal-body">
        <div class="file-info" id="file-info">
          <!-- File info will be populated by JavaScript -->
        </div>

        <div class="column-selection-section">
          <h4>Choose the column containing text to analyze:</h4>
          <div class="columns-list" id="columns-list">
            <!-- Columns will be populated by JavaScript -->
          </div>
        </div>

        <div class="preview-section" id="preview-section" style="display: none;">
          <h4>Preview (first 5 rows):</h4>
          <div class="preview-box" id="preview-box">
            <!-- Preview will be populated by JavaScript -->
          </div>
        </div>

        <div class="load-options">
          <h4>Import Options:</h4>
          <div class="load-options-group">
            <label class="load-option">
              <input type="radio" name="import-mode" value="replace" checked>
              <span class="option-label">Replace current text</span>
              <span class="option-description">Clear existing text and import selected column</span>
            </label>
            <label class="load-option">
              <input type="radio" name="import-mode" value="append">
              <span class="option-label">Append to current text</span>
              <span class="option-description">Add imported data to existing text</span>
            </label>
          </div>

          <div class="text-processing-options">
            <label class="processing-option">
              <input type="checkbox" id="remove-newlines" checked>
              <span class="option-label">Remove newlines from text</span>
              <span class="option-description">Convert multi-line text into single lines (recommended for analysis)</span>
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="column-selection-back">‚Üê Back</button>
        <button type="button" class="btn btn-primary" id="column-selection-import" disabled>Import Data</button>
      </div>
    </div>
  </div>

  <!-- File parsing libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>